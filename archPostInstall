#!/bin/bash

# Packages management with yay
sudo pacman -S --noconfirm --needed git curl wget base-devel &> /dev/null
cd $HOME
git clone https://aur.archlinux.org/yay.git &> /dev/null
cd yay
makepkg -si
cd $HOME
clear

# Install drivers
{
sudo pacman -S --noconfirm xf86-video-nouveau xorg-server xorg-xinit xorg-xsetroot xf86-input-libinput numlockx xsel sxiv
} &> /dev/null
echo "$(tput setaf 2)✓ $(tput sgr0)Drivers Installed"

# Install DE or WM
{
sudo pacman -S --noconfirm arandr bspwm chromium dmenu kitty picom rofi sxhkd neovim nitrogen lxsession
yay -S --noconfirm polybar consolas-font
} &> /dev/null
echo "$(tput setaf 2)✓ $(tput sgr0)Desktop Manager or Window Manager Installed"

# Sound System
{
sudo pacman -S --noconfirm pulseaudio pulseaudio-alsa pavucontrol pamixer playerctl
} &> /dev/null
echo "$(tput setaf 2)✓ $(tput sgr0)Sound system Installed"

# Firewal
{
sudo pacman -S --noconfirm ufw
ufw enable
} &> /dev/null
echo "$(tput setaf 2)✓ $(tput sgr0)Firewall Installed and configured"

# Console
{
sudo pacman -S --noconfirm zsh npm nodejs neofetch openssh
sh -c "$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
git clone https://github.com/zsh-users/zsh-completions ${ZSH_CUSTOM:=~/.oh-my-zsh/custom}/plugins/zsh-completions
} &> /dev/null
echo "$(tput setaf 2)✓ $(tput sgr0)Console Packages Installed"

# Appearance and additional packages
pacman=( 
  adobe-source-{sans-pro,serif-pro}-fonts 
  github-cli 
  gvfs 
  libreoffice-fresh 
  lxappearance 
  mplayer 
  noto-fonts 
  pcmanfm
  reflector 
  ttf-{caladea,carlito,dejavu,linux-libertine-g,roboto-mono}
  ueberzug 
  unrar 
  vifm 
  vlc
  yq
  zathura
  zathura-{cb,djvu,pdf-mupdf,ps}
)
{
sudo pacman -S --noconfirm ${pacman[@]}
} &> /dev/null
echo "$(tput setaf 2)✓ $(tput sgr0)Additional Packages Installed"

# General configurations
git config --global user.name yesiddgarzon
git config --global user.email yesiddgarzon@gmail.com
git config --global color.ui true
git config --global core.editor nvim
ssh -T git@github.com

# Clone dotfiles
cd $HOME
rm .zshrc
{
git clone --bare https://github.com/yesiddgarzon/.dotfiles.git $HOME/.dotfiles
} &> /dev/null
echo "$(tput setaf 2)✓ $(tput sgr0)Dotfiles cloned succesfully, press any key to continue"
read tmpvar
alias dotfiles="/usr/bin/git --git-dir=$HOME/.dotfiles/ --work-tree=$HOME"
dotfiles checkout
dotfiles config --local status.showUntrackedFiles no
sudo cp ~/.config/zsh/gitstart /usr/local/bin

echo "$(tput setaf 2)✓✓✓ $(tput sgr0)Configuration done. You can now exit."
